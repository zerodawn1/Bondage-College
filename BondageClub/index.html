<!DOCTYPE html>
<html style="width:100%; height:100%; padding:0px; margin:0px;">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<meta http-equiv="cache-control" content="max-age=0" />
	<meta http-equiv="cache-control" content="no-cache" />
	<meta http-equiv="expires" content="0" />
	<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
	<meta http-equiv="pragma" content="no-cache" />
	<meta charset="UTF-8">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<title>Bondage Club</title>
	<link rel="icon" type="image/png" href="Icons/Logo.png">
	<link rel="stylesheet" href="CSS/Styles.css">
</head>

<script src="Scripts/Common.js"></script>
<script src="Scripts/Drawing.js"></script>
<script src="Scripts/Timer.js"></script>
<script src="Scripts/GameLog.js"></script>
<script src="Scripts/Reputation.js"></script>
<script src="Scripts/Skill.js"></script>
<script src="Scripts/Character.js"></script>
<script src="Scripts/CharacterName.js"></script>
<script src="Scripts/Dialog.js"></script>
<script src="Scripts/Speech.js"></script>
<script src="Scripts/Text.js"></script>
<script src="Scripts/Inventory.js"></script>
<script src="Scripts/Import.js"></script>
<script src="Scripts/Asset.js"></script>
<script src="Scripts/MiniGame.js"></script>
<script src="Scripts/NPC.js"></script>
<script src="Scripts/Server.js"></script>
<script src="Scripts/Element.js"></script>
<script src="Scripts/Translation.js"></script>
<script src="Scripts/socket.io/socket.io.js"></script>
<script src="Assets/Female3DCG/Female3DCG.js"></script>
<script src="Screens/Character/Login/Login.js"></script>
<script src="Screens/Character/Appearance/Appearance.js"></script>
<script src="Screens/Character/Creation/Creation.js"></script>
<script src="Screens/Character/InformationSheet/InformationSheet.js"></script>
<script src="Screens/Character/Preference/Preference.js"></script>
<script src="Screens/Character/Wardrobe/Wardrobe.js"></script>
<script src="Screens/Character/Cheat/Cheat.js"></script>
<script src="Screens/Character/PasswordReset/PasswordReset.js"></script>
<script src="Screens/Character/FriendList/FriendList.js"></script>
<script src="Screens/Character/Title/Title.js"></script>
<script src="Screens/Room/MainHall/MainHall.js"></script>
<script src="Screens/Room/Shop/Shop.js"></script>
<script src="Screens/Room/Introduction/Introduction.js"></script>
<script src="Screens/Room/MaidQuarters/MaidQuarters.js"></script>
<script src="Screens/Room/Shibari/Shibari.js"></script>
<script src="Screens/Room/Cell/Cell.js"></script>
<script src="Screens/Room/Empty/Empty.js"></script>
<script src="Screens/Room/KidnapLeague/KidnapLeague.js"></script>
<script src="Screens/Room/Private/Private.js"></script>
<script src="Screens/Room/Management/Management.js"></script>
<script src="Screens/Room/SlaveMarket/SlaveMarket.js"></script>
<script src="Screens/Room/Sarah/Sarah.js"></script>
<script src="Screens/Room/AsylumEntrance/AsylumEntrance.js"></script>
<script src="Screens/Room/AsylumBedroom/AsylumBedroom.js"></script>
<script src="Screens/Room/AsylumMeeting/AsylumMeeting.js"></script>
<script src="Screens/Room/AsylumTherapy/AsylumTherapy.js"></script>
<script src="Screens/Room/Gambling/Gambling.js"></script>
<script src="Screens/Room/Prison/Prison.js"></script>
<script src="Screens/Room/Photographic/Photographic.js"></script>
<script src="Screens/Room/Stable/Stable.js"></script>
<script src="Screens/Room/Magic/Magic.js"></script>
<script src="Screens/Room/Nursery/Nursery.js"></script>
<script src="Screens/MiniGame/HorseWalk/HorseWalk.js"></script>
<script src="Screens/MiniGame/Kidnap/Kidnap.js"></script>
<script src="Screens/MiniGame/MaidDrinks/MaidDrinks.js"></script>
<script src="Screens/MiniGame/MaidCleaning/MaidCleaning.js"></script>
<script src="Screens/MiniGame/SlaveAuction/SlaveAuction.js"></script>
<script src="Screens/MiniGame/RhythmGame/RhythmGame.js"></script>
<script src="Screens/Cutscene/PlayerCollaring/PlayerCollaring.js"></script>
<script src="Screens/Cutscene/PlayerMistress/PlayerMistress.js"></script>
<script src="Screens/Cutscene/NPCCollaring/NPCCollaring.js"></script>
<script src="Screens/Cutscene/NPCSlaveAuction/NPCSlaveAuction.js"></script>
<script src="Screens/Cutscene/SarahIntro/SarahIntro.js"></script>
<script src="Screens/Online/ChatSearch/ChatSearch.js"></script>
<script src="Screens/Online/ChatCreate/ChatCreate.js"></script>
<script src="Screens/Online/ChatRoom/ChatRoom.js"></script>
<script src="Screens/Inventory/ItemMouth/PumpGag/PumpGag.js"></script>
<script src="Screens/Inventory/ItemVulva/VibratingEgg/VibratingEgg.js"></script>
<script src="Screens/Inventory/ItemVulva/VibratingLatexPanties/VibratingLatexPanties.js"></script>
<script src="Screens/Inventory/ItemVulva/WandBelt/WandBelt.js"></script>
<script src="Screens/Inventory/ItemNipples/VibeNippleClamp/VibeNippleClamp.js"></script>
<script src="Screens/Inventory/ItemButt/ButtPump/ButtPump.js"></script>
<script src="Screens/Inventory/ItemNeck/ShockCollar/ShockCollar.js"></script>
<script src="Screens/Inventory/ItemNeckAccessories/CollarShockUnit/CollarShockUnit.js"></script>
<script src="Screens/Inventory/ItemArms/LeatherCuffs/LeatherCuffs.js"></script>
<script src="Screens/Inventory/ItemArms/StraitJacket/StraitJacket.js"></script>
<script src="Screens/Inventory/ItemArms/DuctTape/DuctTape.js"></script>
<script src="Screens/Inventory/ItemHands/PaddedMittens/PaddedMittens.js"></script>
<script src="Screens/Inventory/ItemHands/PawMittens/PawMittens.js"></script>
<script src="Screens/Inventory/ItemMouth/ClothGag/ClothGag.js"></script>
<script src="Screens/Inventory/ItemMouth/DuctTape/DuctTape.js"></script>
<script src="Screens/Inventory/ItemMisc/MetalPadlock/MetalPadlock.js"></script>
<script src="Screens/Inventory/ItemMisc/IntricatePadlock/IntricatePadlock.js"></script>
<script src="Screens/Inventory/ItemMisc/TimerPadlock/TimerPadlock.js"></script>
<script src="Screens/Inventory/ItemMisc/OwnerPadlock/OwnerPadlock.js"></script>
<script src="Screens/Inventory/ItemMisc/MistressPadlock/MistressPadlock.js"></script>
<script src="Screens/Inventory/ItemHead/DuctTape/DuctTape.js"></script>
<script src="Screens/Inventory/ItemMouth/PlugGag/PlugGag.js"></script>
<script src="Screens/Inventory/ItemHands/SpankingToys/SpankingToy.js"></script>
<script src="Screens/Inventory/ItemTorso/HempRopeHarness/HempRopeHarness.js"></script>
<script src="Screens/Inventory/ItemPelvis/LoveChastityBelt/LoveChastityBelt.js"></script>
<script src="Screens/Inventory/ItemLegs/LeatherLegCuffs/LeatherLegCuffs.js"></script>
<script src="Screens/Inventory/ItemFeet/LeatherAnkleCuffs/LeatherAnkleCuffs.js"></script>
<script src="Screens/Inventory/ItemNeckAccessories/CollarNameTag/CollarNameTag.js"></script>
<script src="Screens/Inventory/ItemLegs/DuctTape/DuctTape.js"></script>
<script src="Screens/Inventory/ItemFeet/DuctTape/DuctTape.js"></script>
<script src="Screens/Inventory/ItemNeck/SlaveCollar/SlaveCollar.js"></script>
<script src="Screens/Inventory/ItemVulva/VibratingDildo/VibratingDildo.js"></script>
<script src="Screens/Inventory/ItemButt/VibratingButtplug/VibratingButtplug.js"></script>
<script src="Screens/Inventory/ItemNipples/TapedVibeEggs/TapedVibeEggs.js"></script>
<script src="Screens/Inventory/ItemNipples/NippleSuctionCups/NippleSuctionCups.js"></script>
<script src="Screens/Inventory/ItemVulva/ClitSuctionCup/ClitSuctionCup.js"></script>
<script src="Screens/Inventory/ItemVulva/InflatableVibeDildo/InflatableVibeDildo.js"></script>
<script src="Screens/Inventory/ItemButt/InflVibeButtPlug/InflVibeButtPlug.js"></script>
<script src="Screens/Inventory/ItemDevices/TeddyBear/TeddyBear.js"></script>
<script>

/*
	
	NEXT VERISON:

	OK - Love Chastity Belt - Adding shield right after adding belt + Code crash (Sekkmer)
	OK - Move left - Move right (MrsHoudini)
	OK - New HobbleSkirt and Open crotch StraitDress (FeuertinKira)
	OK - Collar Tag Refactor (Sekkmer)
	OK - SpankingToys Fixes (Sekkmer)
	OK - InventoryLock refactor (Sekkmer)
	OK - IsRestraint based on item, not groups (Sekkmer)
	OK - Random appearance error - AllowNone (Sekkmer)
	OK - Legs, wooden horse (Gatetrek)
	OK - Typo fixes / test proofing (klorpa)
	OK - DuctTape extension for feet and legs (FeuertinKira)
	OK - Expanded maid drinks menu (Sociocratic)
	OK - German translation (Adokilume)
	OK - New vibrating butt plug and dildo (FeuertinKira)
	OK - Text cleanup for collar tags (Sekkmer)
	OK - New color picker for custom slave collar (Sekkmer)
	OK - 2 new dresses and sandals (Gatetrek)
	OK - New Witch Hat & Butterfly mask (FeuertinKira + Terenthi)
	OK - New Ankle Socks (TheGnarp)
	OK - Leather Choker, Bone Gag, Pet Collar, New Boots, Fingerless gloves (gatetrek + Kirsty)
	OK - Chat display settings (Adokilume)
	OK - New Lace Babydoll + Sleeveless Top + Jeans (gatetrek)
	OK - Padded mittens + Nursery fixes (wildsj)
	OK - New Spreader bar & Saddle stand (Gnarp)
	OK - Fur dress + socks + gloves (Uwnodi)
	OK - Locking boots + Lots & lots of new clothes (FeuertinKira)
	OK - Item blocking permission system (Sekkmer)
	OK - Frill panties, Frill socks, 5 new hair styles (Gatetrek)
	OK - 6 new backgrounds (FeuertinKira)
	OK - 3 new hoods (FeuertinKira)
	OK - 2 new crotch ropes (Gnarp)
	OK - Ball & chain, Nipple tape, Tape strips, Inflatable vibe dildo (FeuertinKira)
	OK - Chopstick gag (wildsj)
	OK - Fixes for Jeans & Latex Panties (Gatetrek)
	OK - New chastity belt + bra + 3 backgrounds (FeuertinKira)
	OK - Chopstick / tongue split (wildsj)
	OK - Sexy Bikini, inflatable butt plug, Polished mittens (FeuertinKira)
	OK - Chat styles adjustments (Adokilume)
	OK - Police woman hat (Gatetrek)
	TEST - Bamboo gag (Gnarp)
	TEST - Spreader bar on NPCs cannot be removed
	TEST - Teddy bears (Gatetrek)		

	Asylum
	TO DO - Bedroom - The patient can rest on the bed to relax, or be strapped on it for a set time
	OK - Give nurse outfit if reputation > 50
	IN PROGRESS - Treatment Room - Nurses can give treatments and patients can receive them (shock, tickle, orgasm, etc.), nurses get paid and gain reputation
	OK - Random nurses will try to catch escaped patient and bring them back after a fight
	OK - Escaped patients can be identified on their profile (for multiplayer roleplay), forced title
	OK - Meet random patients if dressed as a nurse, can bring them to room or back to asylum after a fight, earn $ and reputation
	OK - Send your sub to the asylum for a while to have their traits changed a little, for a set $ amount

	OK - Management - Allow sub to get a new appearance for slave collar
	OK - Server - Block whispers from players on black list + return an error message to the blacklisted person
	OK - Allow player to choose their favorite title from all available titles (forced title prevails), upload selected title to chatroom for others to see
	OK - Remove prison option from maid rescue missions

	TO DO - Patreon Import/Update
	
*/

// When the code is loaded, we start the game engine
window.onload = function() {
	//CheatImport();
	ServerURL = "https://bondage-club-server.herokuapp.com/";
	CommonIsMobile = CommonDetectMobile();
	TranslationLoad();
	DrawLoad();
	AssetLoadAll();
	CommonSetScreen("Character", "Login");
	ServerInit();
	MainRun(0);
};

// Main game running state, runs the drawing
function MainRun(Timestamp) {
	DrawProcess();
	TimerProcess(Timestamp);
}

// When the user presses a key, we send the KeyDown event to the current screen if it can accept it
function KeyDown(event) {
	if (event.repeat) return;
	KeyPress = event.keyCode || event.which;
	CommonKeyDown();
}

function DocumentKeyDown(event) {
	if (event.repeat) return;
	if (event.key == "Escape") {
		if (typeof window[CurrentScreen + "Exit"] === "function") {
			window[CurrentScreen + "Exit"]();
		} else if ((CurrentCharacter != null) && Array.isArray(DialogMenuButton) && (DialogMenuButton.indexOf("Exit") >= 0)) {
			DialogLeaveItemMenu();
		} else if ((CurrentCharacter != null) && (CurrentScreen == "ChatRoom")) {
			DialogLeave();
		}
	}
}

// When the user clicks, we fire the click event for other screens
function Click(event) {
	if (!CommonIsMobile) {
		MouseMove(event);
		CommonClick();
	}
}

// When the user touches the screen (mobile only), we fire the click event for other screens
function Touch(event) {
	if (CommonIsMobile) {
		var rect = document.getElementById("MainCanvas").getBoundingClientRect();
		if (document.body.clientWidth <= document.body.clientHeight * 2) {
			MouseX = Math.round((event.touches[0].clientX - rect.left) * 2000 / document.body.clientWidth);
			MouseY = Math.round((event.touches[0].clientY - rect.top) * 2000 / document.body.clientWidth);
		} else {
			MouseX = Math.round((event.touches[0].clientX - rect.left) * 1000 / document.body.clientHeight);
			MouseY = Math.round((event.touches[0].clientY - rect.top) * 1000 / document.body.clientHeight);
		}		
		CommonClick();
	} 
}

// When mouse move, we keep the mouse position for other scripts
function MouseMove(event) {
	var rect = document.getElementById("MainCanvas").getBoundingClientRect();
	if (document.body.clientWidth <= document.body.clientHeight * 2) {
		MouseX = Math.round((event.clientX - rect.left) * 2000 / document.body.clientWidth);
		MouseY = Math.round((event.clientY - rect.top) * 2000 / document.body.clientWidth);
	} else {
		MouseX = Math.round((event.clientX - rect.left) * 1000 / document.body.clientHeight);
		MouseY = Math.round((event.clientY - rect.top) * 1000 / document.body.clientHeight);
	}
}

// When the mouse is away from the control, we stop keeping the coordinates, we also check for false positives with "relatedTarget"
function LoseFocus(event) {
	if (event.relatedTarget || event.toElement) {
		MouseX = -1;
		MouseY = -1;
	}
}
 
</script>

<body style="width:100%; height:100%; background-color:black; margin:0px; padding:0px; overflow:hidden;">
	<canvas id="MainCanvas" Width="2000" Height="1000" onClick="Click(event);" onTouchStart="Touch(event);" onMouseMove="MouseMove(event);" onMouseLeave="LoseFocus(event);"></canvas>
</body>
</html>
